Here's my proposed fix:

1. Update the `getJobWithProgress` method in the `DatabaseService` to include the step completion flags in the progress object.

Here's the fix I'm going to implement:

```typescript
const progress: JobProgress = {
  currentStep,
  processedChunks: job.processedChunks || 0,
  totalChunks: job.totalChunks || 0,
  episodes: [], // TODO: 実際のエピソードデータを取得
  splitCompleted: job.splitCompleted || false,
  analyzeCompleted: job.analyzeCompleted || false,
  episodeCompleted: job.episodeCompleted || false,
  layoutCompleted: job.layoutCompleted || false,
  renderCompleted: job.renderCompleted || false,
}
```

This will ensure that the step completion flags are included in the progress object, which will be used by the Web UI to display the progress correctly.

Let me check the `JobProgress` type to see if it needs to be updated to include these step completion flags.

調査結果

Analyze API（POST /api/analyze）のレスポンス後にジョブを初期化する際、DB に書き込んでいる currentStep が "initialized" になっています。
クライアント側の ProcessingProgress コンポーネントは "split"／"chunks_created" のステップしか “チャンク分割中” として扱い、"initialized" は未定義のまま無視するため、アップロード完了後も先に進んだ状態が表示されません。
ブラウザのネットワークタブで /api/jobs/{jobId}/status のポーリングは動いており、サーバー側でもジョブ進捗（split→analyze→…）は更新されていることがターミナルログから確認できています。
修正プラン

サーバー側でジョブ作成直後の初期ステップを "initialized" ではなく "split" にする

route.ts で await jobRepo.updateStep(jobId, 'initialized') の代わりに
await jobRepo.updateStep(jobId, 'split', 0, /_totalChunks未定なら省略可_/) を呼び出す
これでステータス初回取得時からクライアントがチャンク分割開始状態として描画できるようになる
（あるいは）クライアント側で "initialized" を "split" 扱いにマッピングする

ProcessingProgress の updateStepsFromJobData 内で
のような分岐を追加して、“チャンク分割中” にフォールバックする
デバッグ用にクライアントの runOnce 関数内に console.log('polling job status', jobId, data) を挿入し、レンダリング前後でポーリング結果とマッピングが意図どおり動いているかをブラウザのコンソールで確認する

これでアップロード完了後に「チャンク分割」「要素分析」「レイアウト」「レンダリング」と順番にステップが進むはずです。
